var React = require('react-native');
var {
 ListView,
 NavigatorIOS,
 StyleSheet,
} = React;

var Actions = require('flux/actions');
var Store = require('flux/store');

var TodoList = require('components/todo-list');

var styles = StyleSheet.create({
  container: {
    flex: 1
  }
});

var App = React.createClass({
  getInitialState() {
    Actions.setTodo(null);
    return Store.getData();
  },
  onStoreChange() {
    this.setState(Store.getData());
  },
  componentDidMount() {
    Store.addChangeListener(this.onStoreChange);
  },
  componentWillUnmount() {
    Store.removeChangeListener(this.onStoreChange);
  },
  render: function() {
    return (
      <NavigatorIOS
        initialRoute={{
          component: TodoList,
          title: 'Todo',
          passProps: this.state
        }}
        style={styles.container}
      />
    );
  }
});

module.exports = App;
